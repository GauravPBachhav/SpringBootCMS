<!doctype html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Home | Smart Programming</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous" />
</head>

<body>
  <!-- <header>
		<nav
		    class="navbar navbar-expand-lg navbar-dark"
		    style="
		      background-image:
		        linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1)),
		        url(&quot;images/navbarbackground.png&quot;);
		      background-size: cover;
		      background-position: center;
		      background-repeat: no-repeat;
		    "
		  >
        <div class="container">
          <a class="navbar-brand" href="/index">
            <img src="images/logo.png" alt="SmartProgramming" width="60" />
            <span class="h3">Smart Programming</span>
          </a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="/index"
                  >Home</a
                >
              </li>

              <li class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle"
                  href="#"
                  role="button"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  More
                </a>
                <ul class="dropdown-menu">
                  <li>
                    <a class="dropdown-item" href="#">Online Batch Details</a>
                  </li>
                  <li>
                    <hr class="dropdown-divider" />
                  </li>
                  <li><a class="dropdown-item" href="#">Contact Us</a></li>
                  <li><a class="dropdown-item" href="#">About US</a></li>
                </ul>
              </li>
            </ul>

            <a href="/login" class="btn btn-primary ms-4">Login</a>
            <a href="/register" class="btn btn-light ms-4">Register</a>
          </div>
        </div>
      </nav>
    </header> -->



  <div th:if="${sessionUser == null OR sessionUser == ''}">

    <div th:replace="~{fragment/header :: crm-header}"></div>

  </div>


  <div th:unless="${sessionUser == null OR sessionUser == ''}">

    <div th:replace="~{fragment/user-header :: u-header}"></div>
  </div>




  <!---	<div th:replace="~{fragment/header :: crm-header}"></div> -->


  <main class="container-fluid">
    <section>
      <img src="images/banner.jpg" alt="Smart Programming Banner" width="100%" />
    </section>

    <section class="container py-4">
      <h3 class="text-center mb-4">Our Cources</h3>


      <!-- Card Div-->
      <div class="row g-4">


<!-- Card Start-->






<!--  timestamp backend 3  25.50 done for loop for cards  Marked th:each="i : ${#numbers.sequence(1,6)}" 
-->  















        <div th:each="course : ${coursesList}" class="col-lg-3 col-md-6">
          <div class="card" style="width: 18rem">
            <img th:src="@{${course.imageUrl}}" class="card-img-top" alt="Card image cap" />
            <div class="card-body">
              <h5 class="card-title"><span th:text="${course.name}"></span></h5>
              <p class="card-text">
                <span th:text="${course.description}"></span>
              </p>

              <p>
                <strong>Price : </strong> <del>Rs. <span th:text="${course.originalPrice}"></span> </del>
                <span class="bg-light">Rs. <span th:text="${course.discountedPrice}"></span></span>
              </p>

              <div th:if="${sessionUser == null OR sessionUser == ''}">

                <a href="/login" class="btn btn-outline-primary">Login To Buy</a>
              </div>


              <div th:unless="${sessionUser == null OR sessionUser == ''}">

                <button class="btn btn-primary"
				  th:data-cname="${course.name}"
				  th:data-camount="${course.discountedPrice}"
				  th:data-uemail="${sessionUser.email}"
				  th:data-uphoneno="${sessionUser.phoneno}"
				  th:data-uname="${sessionUser.name}"
				  			
				 onclick="purchasecource(this.getAttribute('data-cname') , this.getAttribute('data-camount') ,this.getAttribute('data-uname') ,this.getAttribute('data-uemail') , this.getAttribute('data-uphoneno') )">
					Buy</button>

              </div>



            </div>
            <div class="card-footer text-muted"><span th:text="${course.updatedOn}"></span></div>
          </div>
        </div>


        <!-- Card End-->




      </div>
    </section>
  </main>




  <footer class="footer bg-dark py-3 text-center">


    <div class="container">

      <span class="text-white">@CopyRight Smart Programming </span>

      <div>
        <a href="#" class="ms-3 text-decoration-none">Privacy Policy</a>
        <a href="#" class="ms-3 text-decoration-none">Terms & Condition</a>
        <a href="#" class="ms-3 text-decoration-none">About Us</a>


      </div>

    </div>



  </footer>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
    crossorigin="anonymous"></script>
	
	<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
	<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
	<script>
	function purchasecource(courseName,courseAmount, uname , uemail , uphoneno)
	{



		var options = {
		    "key": "rzp_test_SEWEpdgePUCpmR", // Enter the Key ID generated from the Dashboard
		    "amount": Number(courseAmount) * 100, // Amount is in currency subunits. 
		    "currency": "INR",
		    "name": "Smart Programming",
		    "description": "Cource Management",
		    "image": "https://yt3.ggpht.com/a/AGF-l7_m5NhTMwYl4BZG7NyKgJgfwCLiHJWwcPvw2A=s100-c-k-c0xffffffff-no-rj-mo",
		    //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
		    "handler": function (response){
		        console.log(response);
		        alert("Payment Sucess");
				
				var requestData = {
					
					
					courseName : courseName,
					courseAmount: courseAmount,
					userEmail:uemail ,
					dateOfPurchase: new Date().toLocaleDateString(),
					rzpPaymentId: response.razorpay_payment_id
				}
				
				
				
				$.ajax({
					
					type: "POST",
					url: "/api/storeOrderDetails",
					contentType: "application/json",
					data: JSON.stringify(requestData),
					success: function(response){
					
							console.log("data stored succesfully" , response);
							alert("Congrats, Course Has been Provided");
							window.location.href='/mycources';
							
						
					},
					
					error: function(error)
					{
						
						console.log("Error: "+error);
						alert("Some error occured");
						
						
					}
					
					
					
				});
				
				
		       
		    },
		    "prefill": {
		        "name":uname ,
		        "email": uemail,
		        "contact": uphoneno
		    },
		    "notes": {
		        "CourseName":courseName
		    },
		    "theme": {
		        "color": "#3399cc"
		    }
		};
		var rzp1 = new Razorpay(options);
		rzp1.on('payment.failed', function (response){
		        console.log(response);
		        alert("Error:"+responce);
		      
		});
		 rzp1.open();

	}
	</script>
	
	
	
</body>

</html>








<!--
 
 -->
